# 리눅스 커널 동기화 및 시간 관리

## 1. 커널 시간 관리

### Jiffies
**리눅스 커널 실행 흐름 시간 관리의 기본 단위**

#### 특징
- HZ 값으로 업데이트
- 사람의 초 단위와 다른 커널 내부 시간 단위
- 커널 내 시간 흐름 측정에 사용

## 2. Race Condition

### SMP 시스템에서의 주요 원인
- **SMP 시스템**: 다중 프로세서 환경
- **인터럽트**: 비동기적 실행 흐름
- **선점 스케줄링**: 프로세스 강제 전환
- **메모리 재정렬**: 컴파일러/프로세서 최적화

### 방지 요소
- **단일 스레드 실행**: Race Condition 발생 가능성 낮춤

## 3. 동기화 기법 비교

### 스핀락 (Spinlock)
- **대기 방식**: 바쁘게 기다림 (busy waiting)
- **CPU 사용**: 대기 중에도 CPU 점유
- **사용 컨텍스트**: 인터럽트 핸들러에서 안전

### 뮤텍스 (Mutex)
- **대기 방식**: 슬립 상태로 전환
- **CPU 사용**: 대기 큐에서 CPU 양보
- **사용 제한**: 인터럽트 핸들러에서 사용 불가

## 4. 인터럽트 컨텍스트 동기화

### 안전한 동기화 기법
**스핀락만 사용 가능**

#### 이유
- 인터럽트 핸들러는 슬립 상태 불가
- 뮤텍스의 슬립 특성으로 인한 제약
- 바쁜 대기 방식의 스핀락이 적합

## 5. 데드락 위험

### 뮤텍스 재획득 문제
**이미 획득한 뮤텍스를 다시 획득 시도**

#### 발생 과정
1. 프로세스가 뮤텍스 재획득 시도
2. 대기 큐에 자신을 등록
3. 슬립 상태로 전환
4. 스스로를 깨울 수 없어 영구 슬립

#### 결과
- 데드락 발생
- 프로세스 영구 정지

## 핵심 원칙

1. **시간 관리**: Jiffies 단위 사용
2. **레이스 컨디션**: SMP, 인터럽트, 선점이 주요 원인
3. **스핀락**: 바쁜 대기, 인터럽트 컨텍스트 안전
4. **뮤텍스**: 슬립 대기, 프로세스 컨텍스트만 사용
5. **데드락 방지**: 뮤텍스 재획득 금지